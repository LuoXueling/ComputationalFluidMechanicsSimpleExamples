# 计算流体力学总结

## 第一部分

### CFD研究步骤

1. 问题的界定和流动区域的几何描述
2. 选择控制方程和边界条件
3. 确定网格划分策略和数值方法
4. 程序设计和调试
5. 程序验证和确认
6. 数值解的显示和评价

### 流动模型

在牛顿流体范围内，可以用下列方程描述：

1. 连续性方程
2. 动量方程
3. 能量方程

可压缩粘性流动（Navier-Stokes）：
$$
\left\{\begin{array}{l}
\frac{\partial \rho}{\partial t}+\nabla \cdot(\rho \vec{v})=0 \\
\frac{\partial \vec{v}}{\partial t}+(\vec{v} \cdot \nabla) \vec{v}=-\frac{\nabla p}{\rho}+\frac{1}{\rho}\left(\mu^{\prime}+\frac{\mu}{3}\right) \nabla(\nabla \cdot \vec{v})+v \Delta \vec{v} \\
\frac{\partial e}{\partial t}+(\vec{v} \cdot \nabla) e=-\frac{p}{\rho} \nabla \cdot \vec{v}+\frac{1}{\rho}\left(\mu^{\prime}-\frac{2}{3} \mu\right)(\nabla \cdot \vec{v})^{2}+\frac{2}{\rho} \mu \varepsilon_{i j} \varepsilon_{i j}+\frac{\lambda}{\rho} \frac{\partial^{2} T}{\partial x_{i} x_{i}}
\end{array}\right.
$$
不可压粘性流动（Navier-Stokes）：
$$
\left\{\begin{array}{l}
\nabla \cdot \vec{v}=0 \\
\frac{\partial \vec{v}}{\partial t}+(\vec{v} \cdot \nabla) \vec{v}=-\frac{\nabla p}{\rho}+v \Delta \vec{v}
\end{array}\right.
$$
可压缩无粘流动：
$$
\left\{\begin{array}{l}
\frac{\partial \rho}{\partial t}+\nabla \cdot(\rho \vec{v})=0 \\
\frac{\partial \vec{v}}{\partial t}+(\vec{v} \cdot \nabla) \vec{v}=-\frac{\nabla p}{\rho} \\
\frac{\partial e}{\partial t}+(\vec{v} \cdot \nabla) e=-\frac{p}{\rho} \nabla \cdot \vec{v}
\end{array}\right.
$$
不可压无粘流动：
$$
\left\{\begin{array}{l}
\nabla \cdot \vec{v}=0 \\
\frac{\partial \vec{v}}{\partial t}+(\vec{v} \cdot \nabla) \vec{v}=-\frac{\nabla p}{\rho}
\end{array}\right.
$$
对不可压无粘流动存在势函数满足Laplace方程
$$
\frac{\partial^{2} \varphi}{\partial x^{2}}+\frac{\partial^{2} \varphi}{\partial y^{2}}=0
$$

### 物质导数

物质导数等于当地导数+迁移导数，即对时间的全导数。
$$
\frac{\mathrm{D}\mathbf{u}}{\mathrm{D}t}=\frac{\partial \mathbf{u}}{\partial t}+\mathbf{u}\frac{\partial\mathbf{u}}{\partial x}
$$

### 物理边界条件

### 适合CFD使用的控制方程

守恒型方程，除外力之外的项都在偏微分内。

微分型欧拉方程：
$$
\left\{\begin{array}{l}
\frac{\partial \rho}{\partial t}+u \frac{\partial \rho}{\partial x}+\rho \frac{\partial u}{\partial x}=0 \\
\frac{\partial u}{\partial t}+u \frac{\partial u}{\partial x}+\frac{1}{\rho} \frac{\partial p}{\partial x}=0 \\
\frac{\partial p}{\partial t}+\rho a^{2} \frac{\partial u}{\partial x}+u \frac{\partial p}{\partial x}=0 \\
a^{2}=k R T
\end{array}\right.
$$
守恒型欧拉方程：
$$
\left\{\begin{array}{l}
\frac{\partial \rho}{\partial t}+\frac{\partial(\rho u)}{\partial x}=0 \\
\frac{\partial(\rho u)}{\partial t}+\frac{\partial\left(\rho u^{2}+p\right)}{\partial x}=0 \\
\frac{\partial E}{\partial t}+\frac{\partial[(E+p) u]}{\partial x}=0 \\
E=\frac{p}{k-1}+\frac{\rho u^{2}}{2}
\end{array}\right.
$$

### 模型方程

1. 对流方程
   $$
   \frac{\partial \zeta}{\partial t}+\alpha \frac{\partial \zeta}{\partial x}=0
   $$

2. 波动方程
   $$
   \frac{\partial^{2} \zeta}{\partial t^{2}}=\alpha^{2} \frac{\partial^{2} \zeta}{\partial x^{2}}
   $$

3. 扩散方程
   $$
   \frac{\partial \zeta}{\partial t}=\beta \frac{\partial^{2} \zeta}{\partial x^{2}}
   $$

4. Burgers方程
   $$
   \frac{\partial \zeta}{\partial t}+\zeta \frac{\partial \zeta}{\partial x}=\beta \frac{\partial^{2} \zeta}{\partial x^{2}}
   $$

5. Poisson方程
   $$
   \frac{\partial^{2} \zeta}{\partial x^{2}}+\frac{\partial^{2} \zeta}{\partial y^{2}}=f
   $$

## 偏微分方程的数学性质对CFD的影响

### 降阶

流体力学基本方程都可以写为一阶拟线性方程组的形式。

例：Laplace方程
$$
\frac{\partial^{2} \varphi}{\partial x^{2}}+\frac{\partial^{2} \varphi}{\partial y^{2}}=0
$$
令$u=\frac{\partial \varphi}{\partial x}, v=\frac{\partial \varphi}{\partial y}$，则
$$
\frac{\partial^{2} \varphi}{\partial x^{2}}+\frac{\partial^{2} \varphi}{\partial y^{2}}=0 \Rightarrow\left\{\begin{array}{l}
\frac{\partial u}{\partial x}+\frac{\partial v}{\partial y}=0 \\
\frac{\partial v}{\partial x}-\frac{\partial u}{\partial y}=0
\end{array}\right.
$$

### 一阶拟线性方程的类型

$$
\mathbf{A} \cdot \frac{\partial \mathbf{U}}{\partial x}+\mathbf{B} \cdot \frac{\partial \mathbf{U}}{\partial y}=\mathbf{E}
$$

其中，$\mathbf{U}=\left(U_{1}, U_{2}, \ldots, U_{m}\right)^{T}$，$\mathbf{E}=\left(E_{1}, E_{2}, \ldots, E_{m}\right)^{T}$

如果$\left|\mathbf{A}^{-1} \mathbf{B}-\lambda \mathbf{I}\right|=0$

1. 有m个复数根，方程是严格椭圆型的。
2. 有m个实根，且互不相同，方程是严格双曲型的。
3. 有m个实根，且为m重根，方程是严格抛物型的。

类型可以杂交

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526154348067.png" alt="image-20210526154348067" style="zoom: 50%;" />

### 二阶偏微分方程类型

$$
\sum A_{i} \frac{\partial^{2} \varphi}{\partial x_{i}^{2}}=\sum B_{i} \frac{\partial \varphi}{\partial x_{i}}+C
$$

系数$A_1,A_2,\ldots,A_n$

1. 如果均为正数，方程为椭圆型。
2. 如果部分为负数，其余为正数，方程为双曲型。
3. 如果部分为0，方程为抛物型。

如果有交叉偏导
$$
\mathbf{a}_{11} \mathbf{u}_{\mathbf{x x}}+2 \mathbf{a}_{12} \mathbf{u}_{\mathbf{x y}}+\mathbf{a}_{\mathbf{2 2}} \mathbf{u}_{\mathbf{y y}}+\mathbf{b}_{\mathbf{1}} \mathbf{u}_{\mathbf{x}}+\mathbf{b}_{\mathbf{2}} \mathbf{u}_{\mathbf{y}}+\mathbf{c u}+\mathbf{f}=\mathbf{0}
$$

1. $a_{12}^{2}-a_{11} a_{22}<0$：椭圆型
2. $a_{12}^{2}-a_{11} a_{22}=0$：抛物型
3. $a_{12}^{2}-a_{11} a_{22}>0$：双曲型

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526160825444.png" alt="image-20210526160825444" style="zoom:50%;" />

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526160847963.png" alt="image-20210526160847963" style="zoom:33%;" />

### 双曲型方程的一般性质

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526160140335.png" alt="image-20210526160140335" style="zoom: 50%;" />

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526160219147.png" alt="image-20210526160219147" style="zoom:50%;" />

双曲型方程的特征根实根就是特征线的斜率$dx/dt$

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526160542505.png" alt="image-20210526160542505" style="zoom: 33%;" />

1. 偏微分方程的部分信息在相应的特征线上传播，信息传播的速度就是相应的特征值
2. 将所有特征线上与之相容的特征关系综合起来，与原偏微分方程是等价的。可以利用特征线法求解双曲型方程
3. 时间变量（或类时间变量）具有单向性。因此，双曲型方程是发展型方程，可以沿时间方向推进求解。

### 抛物线方程的性质

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526161151513.png" alt="image-20210526161151513" style="zoom:50%;" />

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526161456003.png" alt="image-20210526161456003" style="zoom:50%;" />

1. 由于有重根，所有特征线上包含的信息少于原偏微分方程。因此，不能用特征线法求解抛物型方程
2. 特征值均为实数，时间变量（或类时间变量）具有单向性。因此，也为发展型方程，同样可以沿时间方向推进求解。

### 椭圆型方程的性质

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526161702535.png" alt="image-20210526161702535" style="zoom: 50%;" />

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526161722466.png" alt="image-20210526161722466" style="zoom:50%;" />

1. 由于特征值均为复数，所以无法定义特征线及其与之相容的特征关系；
2. 不能沿某一方向推进求解，必须整个计算域同时求解；
3. 椭圆型对应着一种稳态平衡的过程，又称为平衡方程。

### 定解条件

在解决实际流动问题中，要求一个解，不仅要满足微分方程，还要满足某些附加条件，例如初始条件或边值条件。

对与偏微分方程有关的物理问题，必须考察给出方程的合理性，同时要考虑对附加条件提法的要求。这样，就需要研究偏微分方程定解问题在数学上的适定性。

初始条件和边界条件是确定微分方程解必不可少的条件，合称为定解条件。

1. 定解条件少给了，无法定解，即所谓欠定；
2. 多给了可能产生矛盾，即所谓过定；
3. 只有给出适当个数的定解条件才能求解，即所谓适定。

**解的存在性与唯一性**

定解域边界上的某点是否要给出定解条件，可从该点处作特征线，若其方向指向定解域内，则需要给出定解条件，否则不必给。

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526162132311.png" alt="image-20210526162132311" style="zoom:50%;" />

## 离散化的基本方法

速度势函数与流函数满足Laplace方程
$$
\left\{\begin{array}{l}
\frac{\partial^{2} \varphi}{\partial x^{2}}+\frac{\partial^{2} \varphi}{\partial y^{2}}=0 \\
S_{1}: \varphi=A(x, y) \\
S_{2}: \frac{\partial \varphi}{\partial n}=B(x, y)
\end{array}\right.
$$

### 差分

| 向前差分                                                     | 向后差分                                                     | 中心差分                                                     |
| ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| $\Delta y=f(x+\Delta x)-f(x)$                                | $\Delta y=f(x)-f(x-\Delta x)$                                | $\Delta y=f(x+\Delta x / 2)-f(x-\Delta x / 2)$               |
| $\begin{aligned}\Delta^{2} y=& f(x+2 \Delta x) \\&-2 f(x+\Delta x)+f(x)\end{aligned}$ | $\begin{aligned}\Delta^{2} y=& f(x)-2 f(x-\Delta x) \\+& f(x-2 \Delta x)\end{aligned}$ | $\begin{aligned}\Delta^{2} y &=f(x+\Delta x)-2 f(x) \\&+f(x-\Delta x)\end{aligned}$ |

一阶向前差商
$$
\frac{\Delta y}{\Delta x}=\frac{f(x+\Delta x)-f(x)}{\Delta x}
$$

一阶向后差商

$$
\frac{\Delta y}{\Delta x}=\frac{f(x)-f(x-\Delta x)}{\Delta x}
$$

一阶中心差商

$$
\frac{\Delta y}{\Delta x}=\frac{f(x+1 / 2 \Delta x)-f(x-1 / 2 \Delta x)}{\Delta x}=\frac{f(x+\Delta x)-f(x-\Delta x)}{2 \Delta x}
$$
二阶中心差商

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526164724587.png" alt="image-20210526164724587" style="zoom:50%;" />

### 逼近误差

差商与导数之间的误差表明差商逼近导数的程度，称为逼近误差。

由函数的Taylor级数展开，可以得到逼近误差相对于自变量差分（增量）的量级，称为用差商代替导数的精度，简称为差商的精度。

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526164945405.png" alt="image-20210526164945405" style="zoom:50%;" />

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526165014562.png" alt="image-20210526165014562" style="zoom:48%;" />

### 构造差分

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526165348024.png" alt="image-20210526165348024" style="zoom: 50%;" />

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526165405559.png" alt="image-20210526165405559" style="zoom: 67%;" />

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526165422855.png" alt="image-20210526165422855" style="zoom: 50%;" />

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526165439186.png" alt="image-20210526165439186" style="zoom: 50%;" />

### 差分方程

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526170147342.png" alt="image-20210526170147342" style="zoom:50%;" />

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526170209217.png" alt="image-20210526170209217" style="zoom:50%;" />

时间向前（一阶精度）、空间中心差分（二阶精度）（FTCS），误差为

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526170300193.png" alt="image-20210526170300193" style="zoom:50%;" />

### 差分格式

差分方程+**定解条件**=差分格式

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526170356574.png" alt="image-20210526170356574" style="zoom:50%;" />

改写为

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526170408582.png" alt="image-20210526170408582" style="zoom:50%;" />

### 相容性

截断误差R

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526170731992.png" alt="image-20210526170731992" style="zoom:50%;" />

定解条件误差r

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526170749673.png" alt="image-20210526170749673" style="zoom:50%;" />

相容性是描述差分格式的。

### 收敛性

**收敛性**：当步长趋于零时，要求差分格式的解趋于微分方程定解问题的解。

**离散化误差**：差分格式的解与微分问题的解的差。

当$\Delta x,\Delta t \rightarrow0$时离散化误差的某种范数趋近于0，则差分格式收敛。

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526172957575.png" alt="image-20210526172957575" style="zoom:50%;" />

收敛性分为：**不收敛、条件收敛、无条件收敛**

收敛性是描述差分解的。

因此**相容性是收敛性的必要条件**

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526173218108.png" alt="image-20210526173218108" style="zoom:50%;" />

对于对流方程

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526173533573.png" alt="image-20210526173533573" style="zoom:50%;" />

列离散化误差方程

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526173559023.png" alt="image-20210526173559023" style="zoom:50%;" />

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526173754163.png" alt="image-20210526173754163" style="zoom:50%;" />

通过放缩得到

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526174051290.png" alt="image-20210526174051290" style="zoom: 67%;" />

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526174123815.png" alt="image-20210526174123815" style="zoom:50%;" />

即离散化误差最大值趋于0，称一致收敛。

FTBS在$0<\alpha \frac{\Delta t}{\Delta x}\le1$时收敛

FTFS在$-1\le\alpha \frac{\Delta t}{\Delta x}<0$时收敛

### 稳定性

将图中的$\zeta$换成$e$可得误差传播规律

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526174537157.png" alt="image-20210526174537157" style="zoom:40%;" />

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526174627312.png" alt="image-20210526174627312" style="zoom: 40%;" />

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526174640369.png" alt="image-20210526174640369" style="zoom:40%;" />

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526175144390.png" alt="image-20210526175144390" style="zoom:50%;" />

误差传播方程：

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526175216035.png" alt="image-20210526175216035" style="zoom:50%;" />

改写为：

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526175230340.png" alt="image-20210526175230340" style="zoom:50%;" />

假设空间误差向右是增大的

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526175531093.png" alt="image-20210526175531093" style="zoom:50%;" />

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526175547480.png" alt="image-20210526175547480" style="zoom:50%;" />

误差传播方程也可以像收敛性判断那样分析，可以证明FTBS是一致稳定的，不能证明FTCS是稳定的。

#### Von Neuman稳定性分析方法

以对流方程FTBS为例，误差传播方程

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526180713175.png" alt="image-20210526180713175" style="zoom:50%;" />

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526180724307.png" alt="image-20210526180724307" style="zoom:50%;" />

傅里叶展开只取一项即可

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526180755488.png" alt="image-20210526180755488" style="zoom:50%;" />

稳定的必要条件

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526180927573.png" alt="image-20210526180927573" style="zoom:50%;" />

FTBS的稳定性条件与收敛性条件相同

稳定性描述的是计算误差

### Lax等价定理

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526174852586.png" alt="image-20210526174852586" style="zoom:50%;" />

**Lax等价定理**：对于一个适定的线性微分问题及一个与其相容的差分格式，如果该格式稳定，则必收敛；不稳定则必不收敛。（适定是定解条件合适）

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526181056867.png" alt="image-20210526181056867" style="zoom:50%;" />

### 显示方法与隐式方法

显示格式往往条件稳定，甚至不稳定

* 对流方程FTCS完全不稳定
* 对流方程BTCS完全稳定
* 热传导方程BTCS完全稳定
* 热传导方程FTCS条件稳定

隐式格式常常无条件稳定

隐式格式的$\Delta t$可以更大，但是要联立求解方程

隐式格式多用于扩散方程

## 计算流体力学的基本方法

### 迎风格式

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526210033276.png" alt="image-20210526210033276" style="zoom: 33%;" />

### Lax格式

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526202435064.png" alt="image-20210526202435064" style="zoom: 33%;" />

### Lax-Wendroff格式

求解双曲型和抛物型方程

泰勒展开求解流动参数

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526203102771.png" alt="image-20210526203102771" style="zoom:33%;" />

其中的偏导数用控制方程求解

一阶偏导：

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526203136467.png" alt="image-20210526203136467" style="zoom:33%;" />

![image-20210526203209218](G:\计算流体力学\计算流体力学总结.assets\image-20210526203209218.png)

二阶偏导对控制方程求偏导数得到

### MacCormack格式

计算双曲型和抛物型方程，基本思路和Lax-Wendroff一样

先用一阶向前差分预估，再用一阶向后差分与向前差分的平均值作校正。

向前和向后的顺序可以交换。

### 求解椭圆型方程的松弛法

Laplace方程

二阶中心差分：

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526204321697.png" alt="image-20210526204321697" style="zoom:40%;" />

化为迭代式

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526204321697.png" alt="image-20210526204321697" style="zoom:40%;" />

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526204345745.png" alt="image-20210526204345745" style="zoom:40%;" />

逐点求解

### 数值耗散、色散、人工粘性

原方程：

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526204621216.png" alt="image-20210526204621216" style="zoom: 33%;" />

加粘性

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526204642282.png" alt="image-20210526204642282" style="zoom: 33%;" />

二阶（偶数阶）导为数值粘性，三阶（奇数阶）导为数值色散。数值色散的作用与数值粘性相反。

假设用MacCormack格式，添加人工粘性，则预估步和校正步添加同样的粘性项。

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526205044721.png" alt="image-20210526205044721" style="zoom: 33%;" />

### 交替方向隐式方法（ADI）

对非定常二维热传导方程为：

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526205306387.png" alt="image-20210526205306387" style="zoom: 33%;" />

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526205322030.png" alt="image-20210526205322030" style="zoom: 40%;" />

### 压强修正法

不可压缩黏性流体的控制方程组具有椭圆型-抛物型的混合性质，求椭圆型方程的松弛法不再适用

不可压N-S方程组

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526205532954.png" alt="image-20210526205532954" style="zoom:40%;" />

问题一：奇偶失联，用中心差分时，奇数项计算奇数项、偶数项计算偶数项（可压流不会奇偶失联：连续方程包含密度→抹平锯齿形。）

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526205552818.png" alt="image-20210526205552818" style="zoom:40%;" />

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526205652996.png" alt="image-20210526205652996" style="zoom:40%;" />

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526205826472.png" alt="image-20210526205826472" style="zoom:40%;" />

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526205844634.png" alt="image-20210526205844634" style="zoom:40%;" />

解决奇偶失联：迎风差分代替中心差分；交错网格上使用中心差分。

问题二：压强没有控制方程

压强修正法：首先假设一个压强，然后求解动量方程得到速度，再把速度代入连续方程，若不满足，则修正压强重新计算。压强修正法本质上是一种**迭代**方法。

## 拟一维喷管流动数值解

注意特征线方向，确定物理边界条件。没有物理边界条件的补充外推的数值边界条件。

## 圆柱绕流

<img src="G:\计算流体力学\计算流体力学总结.assets\image-20210526211706144.png" alt="image-20210526211706144" style="zoom:50%;" />

如果右侧无点、下侧无点，则用非正则内点，$\Psi_1=\Psi_2=0$

如果右侧有点，下侧无点，则用非正则内殿，$\Psi_1=\Psi_{i+1,j},\Psi_2=0$

如果右侧无点，下侧有点，则用非正则内殿，$\Psi_1=0,\Psi_2=\Psi_{i,j-1}$
